Transfer learning (2016)
======================
Python and Matlab implementation of transfer learning algorithms for domain adaptation.
This code has been tested on Matlab R2015b and Anacoda python on a windows system.
========================================================================================
Overview
The folder "data" contains the original NSL_KDD and some split data for transfer learning.
To run the transfer learning "HeMap" and classification, just follow the 1 and 2.


1.Transfer learning algorithms "HeTL" is implemented in Matlab, which is in "matlab"  folder.
================
Data Description
================

(1)In "matlab/data" folder, there are 3 transfer learning tasks, they're:
  "dos_vs_probe"
  "dos_vs_r2l"
  "probe_vs_r2l"
(2)For each task, the input data is under each folder.
  "source.x.dat" is the features of instances in the source domain. 
  "source.y.dat" is the labels of the corresponding instances in "source.x.dat"
  "target.x.dat" is the features of instances in the target domain. 
  "target.y.dat" is the labels of the corresponding instances in "target.x.dat"
  #The HeMap needs the source and target should be the same size of the instances. The feature dimensions can be different.
(3)Within each task folder, there is a "result" folder, which is for the output results for the transfer learning codes. 
   The "result" folder will contain several folders with the names of the combinations of the parameters.
   The codes will produce the new projected data named "transformed_source.csv" and "transformed_target.csv" in each subfolder.

================
Code Description
================
(1)There is 5 files related files."run_heMap_simple.m" and "run_heMap.m" are both examples of running HeMap. "run_heMap_simple.m" only generate one group of new source and target with your manually setting parameters k and b and the options of normalization. "run_heMap.m" is automatically literally setting the k and b and generate all the results for the combinations for k,b and the normalization.


To run the algorithm, please type in "run_heMap" in Matlab command line; The output results will be written to the folder "matlab/data/[task_name]/result"
  
Please specify your file_path to the transfer learning task.
================================================================================================================================================
  
2.Classification on new transformed data by HeMap, which is implemented in python, in "python" folder.
================
Code Description
================
(1)"Classification_domain_adaption.py"  is to produce the classification results for the transformed data by "HeMap".  
It will read all the "transformed_source.csv" and "transformed_target.csv" generated by "run_heMap.m", located in matlab/{transfer learning task}/result.
The output result will be either printed on the screen and directly written to a csv file containing all the metrics result under the subfolder 'result'
Please specify "domain" to your transfer learning task.

=================
Result Description
=================
The generated classfication results contains k,b,isnormlized and several metrics for each classfier. The metrics is "accuracy" (ac),"precision"(p),"recall","f1","auc". Each row is results for the combinations for parameters k,b and is isnormlized.
The last two rows are the best values for the current metric of current classifier and the corresponding best parameters.
================================================================================================================================================

3. View, plot the data and the baseline for NSL_KDD
The viewing, plotting, and baseline approaches are implemented in ipython notebook.
The corresponding data for viewing, baseline is in the subfolder "data". The formats are csv.

Summary.ipynb
 -View　feature distribution of NSL_KDD data.
tsne.ipynb
 -View high dimensions data.
Classification-baseline.ipynb
 -run the classfication before transfer learning as baselines
Plot_roc_curve.ipynb
 -Plot_roc_curve. Specifiy the data folder.
 
================================================================================================================================================
4.Other utility codes
python/SelecteSamples.py
 -Generating samples from large NSL_KDD dataset.

* Please feel free to contact zhaojuanwendy@gmail.com if come up with any problem.

===============
References
===============
1.Xiaoxiao Shi, Qi Liu, Wei Fan, Philip S. Yu, and Ruixin Zhu. Transfer learning on heterogenous feature spaces via spectral transformation. In Proceedings - IEEE International Conference on Data Mining, ICDM, pages 1049–1054, 2010


